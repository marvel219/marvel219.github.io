{"title":"网络爬虫/相关工具与知识","uid":"7c3a6f7ad545b7833c547c40303b5d4d","slug":"newpaper","date":"2022-05-30T08:49:18.000Z","updated":"2022-05-30T10:37:55.531Z","comments":true,"path":"api/articles/newpaper.json","keywords":null,"cover":null,"content":"<h2 id=\"网络爬虫\"><a href=\"#网络爬虫\" class=\"headerlink\" title=\"网络爬虫\"></a>网络爬虫</h2><p>网络爬虫(web crawler), 以前经常称为网络蜘蛛(spider), 是按照一定的规则自动浏览万维网并获取信息的机器人程序(或叫脚本), 曾经被广泛的应用于互联网搜索引擎.<br>使用过互联网和浏览器的人都知道, 网页中除了提供用户阅读的文字信息之外, 还包含一些超链接. 网络爬虫系统正是通过网页中的超链接信息不断获得网络上的其他页面. 正因为如此, 网络数据采集的过程就像一个爬虫或者蜘蛛在网络上漫游, 所有才被形象的称之为网络爬虫或者网络蜘蛛.</p>\n<h3 id=\"爬虫的应用领域\"><a href=\"#爬虫的应用领域\" class=\"headerlink\" title=\"爬虫的应用领域\"></a>爬虫的应用领域</h3><p>在理想的状态下, 所有的ICP(internet Content Provider) 都应该为自己的网络提供API接口来共享它们允许其他程序获取的数据, 在这种情况下爬虫就不是必需品, 国内比较有名的电商平台(如淘宝, 京东等), 社交平台(如QQ&#x2F;微博&#x2F;微信等)这些网站都提供了自己的Open Api, 但是这类Open Api通常会对可以抓取的数据频率进行限制. 对于大多数的公司而言, 计时的获取行业相关数据就是企业生存的重要环节之一, 然而大部分企业在行业数据方面的匮乏是其与生俱来的短板, 合理的利用爬虫来获取数据并从中提取出有价值的信息是至关重要的. 当然爬虫还有很多重要的应用灵玉, 以下列举了其中一部分.</p>\n<pre class=\"line-numbers language-bash\" data-language=\"bash\"><code class=\"language-bash\"><span class=\"token number\">1</span>. 搜索引擎\n<span class=\"token number\">2</span>. 新闻聚合\n<span class=\"token number\">3</span>. 社交应用\n<span class=\"token number\">4</span>. 舆情监控\n<span class=\"token number\">5</span>. 行业数据<span aria-hidden=\"true\" class=\"line-numbers-rows\"><span></span><span></span><span></span><span></span><span></span></span></code></pre>\n<h3 id=\"Rbots-txt文件\"><a href=\"#Rbots-txt文件\" class=\"headerlink\" title=\"Rbots.txt文件\"></a>Rbots.txt文件</h3><p>大多数网站都会定义robots.txt文件, 下面以淘宝的robots.txt文件为例, 看看该网站对爬虫有哪些限制</p>\n<pre class=\"line-numbers language-bash\" data-language=\"bash\"><code class=\"language-bash\"><span class=\"token variable\">$User</span>-agent:  Baiduspider\nAllow:  /article\nAllow:  /oshtml\nDisallow:  /product/\nDisallow:  /\n\nUser-Agent:  Googlebot\nAllow:  /article\nAllow:  /oshtml\nAllow:  /product\nAllow:  /spu\nAllow:  /dianpu\nAllow:  /oversea\nAllow:  /list\nDisallow:  /\n\nUser-agent:  Bingbot\nAllow:  /article\nAllow:  /oshtml\nAllow:  /product\nAllow:  /spu\nAllow:  /dianpu\nAllow:  /oversea\nAllow:  /list\nDisallow:  /\n\nUser-Agent:  360Spider\nAllow:  /article\nAllow:  /oshtml\nDisallow:  /\n\nUser-Agent:  Yisouspider\nAllow:  /article\nAllow:  /oshtml\nDisallow:  /\n\nUser-Agent:  Sogouspider\nAllow:  /article\nAllow:  /oshtml\nAllow:  /product\nDisallow:  /\n\nUser-Agent:  Yahoo<span class=\"token operator\">!</span>  Slurp\nAllow:  /product\nAllow:  /spu\nAllow:  /dianpu\nAllow:  /oversea\nAllow:  /list\nDisallow:  /\n\nUser-Agent:  *\nDisallow:  /<span aria-hidden=\"true\" class=\"line-numbers-rows\"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>\n<p>注意上面robots.txt第一段的最后一行, 通过设置’Disallow:&#x2F;’禁止百度爬虫访问除了’Allow’规定页面外的其他所有页面. 因此当你在百度搜索’淘宝’的时候, 搜索结果下方会出现: ‘由于该网站的rebots.txt文件存在限制指令(限制搜索引擎抓取). 系统无法提供该页面的内容描述.’, 百度作为一个搜索引擎, 至少在表面上遵守了淘宝网的robots.txt协议, 所以用户不能从百度上搜索到淘宝内部的产品信息.</p>\n<h2 id=\"相关工具介绍\"><a href=\"#相关工具介绍\" class=\"headerlink\" title=\"相关工具介绍\"></a>相关工具介绍</h2><p>在开始讲解爬虫之前，我们稍微对HTTP（超文本传输协议）做一些回顾，因为我们在网页上看到的内容通常是浏览器执行HTML语言得到的结果，而HTTP就是传输HTML数据的协议。HTTP是构建于TCP（传输控制协议）之上应用级协议，它利用了TCP提供的可靠的传输服务实现了Web应用中的数据交换。按照维基百科上的介绍，设计HTTP最初的目的是为了提供一种发布和接收HTML页面的方法，也就是说这个协议是浏览器和Web服务器之间传输的数据的载体。关于这个协议的详细信息以及目前的发展状况，大家可以阅读阮一峰老师的<a href=\"http://www.ruanyifeng.com/blog/2016/08/http.html\">《HTTP 协议入门》</a>、<a href=\"http://www.ruanyifeng.com/blog/2012/05/internet_protocol_suite_part_i.html\">《互联网协议入门》</a>系列以及<a href=\"http://www.ruanyifeng.com/blog/2014/09/illustration-ssl.html\">《图解HTTPS协议》</a>进行了解，下图是我在2009年9月10日凌晨4点在四川省网络通信技术重点实验室用开源协议分析工具Ethereal（抓包工具WireShark的前身）截取的访问百度首页时的HTTP请求和响应的报文（协议数据），由于Ethereal截取的是经过网络适配器的数据，因此可以清晰的看到从物理链路层到应用层的协议数据。</p>\n<h3 id=\"相关工具\"><a href=\"#相关工具\" class=\"headerlink\" title=\"相关工具\"></a>相关工具</h3><p>1.Chrome Developer Tools</p>\n<p>开发推荐使用谷歌浏览器, 这是谷歌的开发者工具</p>\n<p>2.HTTPie</p>\n<pre class=\"line-numbers language-bash\" data-language=\"bash\"><code class=\"language-bash\">$ http --header http://www.scu.edu.cn\nHTTP/1.1 <span class=\"token number\">200</span> OK\nAccept-Ranges: bytes\nCache-Control: private, max-age<span class=\"token operator\">=</span><span class=\"token number\">600</span>\nConnection: Keep-Alive\nContent-Encoding: <span class=\"token function\">gzip</span>\nContent-Language: zh-CN\nContent-Length: <span class=\"token number\">14403</span>\nContent-Type: text/html\nDate: Sun, <span class=\"token number\">27</span> May <span class=\"token number\">2018</span> <span class=\"token number\">15</span>:38:25 GMT\nETag: <span class=\"token string\">\"e6ec-56d3032d70a32-gzip\"</span>\nExpires: Sun, <span class=\"token number\">27</span> May <span class=\"token number\">2018</span> <span class=\"token number\">15</span>:48:25 GMT\nKeep-Alive: <span class=\"token assign-left variable\">timeout</span><span class=\"token operator\">=</span><span class=\"token number\">5</span>, <span class=\"token assign-left variable\">max</span><span class=\"token operator\">=</span><span class=\"token number\">100</span>\nLast-Modified: Sun, <span class=\"token number\">27</span> May <span class=\"token number\">2018</span> <span class=\"token number\">13</span>:44:22 GMT\nServer: VWebServer\nVary: User-Agent,Accept-Encoding\nX-Frame-Options: SAMEORIGIN<span aria-hidden=\"true\" class=\"line-numbers-rows\"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>\n<p>3.BuiltWith(python自带的模块): 识别网站使用的技术</p>\n<pre class=\"line-numbers language-bash\" data-language=\"bash\"><code class=\"language-bash\"><span class=\"token operator\">>></span><span class=\"token operator\">></span>\n<span class=\"token operator\">>></span><span class=\"token operator\">></span> <span class=\"token function\">import</span> builtwith\n<span class=\"token operator\">>></span><span class=\"token operator\">></span> builtwith.parse<span class=\"token punctuation\">(</span><span class=\"token string\">'http://www.bootcss.com/'</span><span class=\"token punctuation\">)</span>\n<span class=\"token punctuation\">&#123;</span><span class=\"token string\">'web-servers'</span><span class=\"token builtin class-name\">:</span> <span class=\"token punctuation\">[</span><span class=\"token string\">'Nginx'</span><span class=\"token punctuation\">]</span>, <span class=\"token string\">'font-scripts'</span><span class=\"token builtin class-name\">:</span> <span class=\"token punctuation\">[</span><span class=\"token string\">'Font Awesome'</span><span class=\"token punctuation\">]</span>, <span class=\"token string\">'javascript-frameworks'</span><span class=\"token builtin class-name\">:</span> <span class=\"token punctuation\">[</span><span class=\"token string\">'Lo-dash'</span>, <span class=\"token string\">'Underscore.js'</span>, <span class=\"token string\">'Vue.js'</span>, <span class=\"token string\">'Zepto'</span>, <span class=\"token string\">'jQuery'</span><span class=\"token punctuation\">]</span>, <span class=\"token string\">'web-frameworks'</span><span class=\"token builtin class-name\">:</span> <span class=\"token punctuation\">[</span><span class=\"token string\">'Twitter Bootstrap'</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">&#125;</span>\n\n<span class=\"token operator\">>></span><span class=\"token operator\">></span>\n<span class=\"token operator\">>></span><span class=\"token operator\">></span> <span class=\"token function\">import</span> ssl\n<span class=\"token operator\">>></span><span class=\"token operator\">></span> ssl._create_default_https_context <span class=\"token operator\">=</span> ssl._create_unverified_context\n<span class=\"token operator\">>></span><span class=\"token operator\">></span> builtwith.parse<span class=\"token punctuation\">(</span><span class=\"token string\">'https://www.jianshu.com/'</span><span class=\"token punctuation\">)</span>\n<span class=\"token punctuation\">&#123;</span><span class=\"token string\">'web-servers'</span><span class=\"token builtin class-name\">:</span> <span class=\"token punctuation\">[</span><span class=\"token string\">'Tengine'</span><span class=\"token punctuation\">]</span>, <span class=\"token string\">'web-frameworks'</span><span class=\"token builtin class-name\">:</span> <span class=\"token punctuation\">[</span><span class=\"token string\">'Twitter Bootstrap'</span>, <span class=\"token string\">'Ruby on Rails'</span><span class=\"token punctuation\">]</span>, <span class=\"token string\">'programming-languages'</span><span class=\"token builtin class-name\">:</span> <span class=\"token punctuation\">[</span><span class=\"token string\">'Ruby'</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">&#125;</span><span aria-hidden=\"true\" class=\"line-numbers-rows\"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>\n\n<p>4.robotparser: 解析robots.txt的工具</p>\n<pre class=\"line-numbers language-bash\" data-language=\"bash\"><code class=\"language-bash\"><span class=\"token operator\">>></span><span class=\"token operator\">></span> from urllib <span class=\"token function\">import</span> robotparser\n<span class=\"token operator\">>></span><span class=\"token operator\">></span> parser <span class=\"token operator\">=</span> robotparser.RobotFileParser<span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span>\n<span class=\"token operator\">>></span><span class=\"token operator\">></span> parser.set_url<span class=\"token punctuation\">(</span><span class=\"token string\">'https://www.taobao.com/robots.txt'</span><span class=\"token punctuation\">)</span>\n<span class=\"token operator\">>></span><span class=\"token operator\">></span> parser.read<span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span>\n<span class=\"token operator\">>></span><span class=\"token operator\">></span> parser.can_fetch<span class=\"token punctuation\">(</span><span class=\"token string\">'Hellokitty'</span>, <span class=\"token string\">'http://www.taobao.com/article'</span><span class=\"token punctuation\">)</span>\nFalse\n<span class=\"token operator\">>></span><span class=\"token operator\">></span> parser.can_fetch<span class=\"token punctuation\">(</span><span class=\"token string\">'Baiduspider'</span>, <span class=\"token string\">'http://www.taobao.com/article'</span><span class=\"token punctuation\">)</span>\nTrue\n<span class=\"token operator\">>></span><span class=\"token operator\">></span> parser.can_fetch<span class=\"token punctuation\">(</span><span class=\"token string\">'Baiduspider'</span>, <span class=\"token string\">'http://www.taobao.com/product'</span><span class=\"token punctuation\">)</span>\nFalse<span aria-hidden=\"true\" class=\"line-numbers-rows\"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>","text":"网络爬虫网络爬虫(web crawler), 以前经常称为网络蜘蛛(spider), 是按照一定的规则自动浏览万维网并获取信息的机器人程序(或叫脚本), 曾经被广泛的应用于互联网搜索引擎.使用过互联网和浏览器的人都知道, 网页中除了提供用户阅读的文字信息之外, 还包含一些超链接....","link":"","photos":[],"count_time":{"symbolsCount":"3.6k","symbolsTime":"3 mins."},"categories":[],"tags":[{"name":"网络爬虫","slug":"网络爬虫","count":1,"path":"api/tags/网络爬虫.json"}],"toc":"<ol class=\"toc\"><li class=\"toc-item toc-level-2\"><a class=\"toc-link\" href=\"#%E7%BD%91%E7%BB%9C%E7%88%AC%E8%99%AB\"><span class=\"toc-text\">网络爬虫</span></a><ol class=\"toc-child\"><li class=\"toc-item toc-level-3\"><a class=\"toc-link\" href=\"#%E7%88%AC%E8%99%AB%E7%9A%84%E5%BA%94%E7%94%A8%E9%A2%86%E5%9F%9F\"><span class=\"toc-text\">爬虫的应用领域</span></a></li><li class=\"toc-item toc-level-3\"><a class=\"toc-link\" href=\"#Rbots-txt%E6%96%87%E4%BB%B6\"><span class=\"toc-text\">Rbots.txt文件</span></a></li></ol></li><li class=\"toc-item toc-level-2\"><a class=\"toc-link\" href=\"#%E7%9B%B8%E5%85%B3%E5%B7%A5%E5%85%B7%E4%BB%8B%E7%BB%8D\"><span class=\"toc-text\">相关工具介绍</span></a><ol class=\"toc-child\"><li class=\"toc-item toc-level-3\"><a class=\"toc-link\" href=\"#%E7%9B%B8%E5%85%B3%E5%B7%A5%E5%85%B7\"><span class=\"toc-text\">相关工具</span></a></li></ol></li></ol>","author":{"name":"Aurora","slug":"blog-author","avatar":"https://img-blog.csdnimg.cn/20210313122054101.png","link":"/","description":"","socials":{"github":"","twitter":"","stackoverflow":"","wechat":"","qq":"","weibo":"","zhihu":"","csdn":"","juejin":"","customs":{}}},"mapped":true,"prev_post":{},"next_post":{}}